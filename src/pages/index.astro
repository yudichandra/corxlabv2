---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import { getCollection } from 'astro:content';

const games = (await getCollection('games')).sort((a, b) => +b.data.pubDate - +a.data.pubDate).slice(0, 6);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
		<style>
			.hero { max-width: 960px; margin: 0 auto; padding: 2rem 1rem; text-align: center; }
			.hero h1 { margin-bottom: .5rem; }
			.hero p { color: rgb(var(--gray)); }
			.stack { display: flex; gap: .75rem; justify-content: center; flex-wrap: wrap; margin: 1rem 0 2rem; }
			.badge { padding: .4rem .75rem; border-radius: 999px; background: rgb(var(--gray-light)); color: rgb(var(--gray-dark)); font-weight: 700; }
			.grid { max-width: 960px; margin: 0 auto; padding: 0 1rem 2rem; display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; }
			.card { background: #fff; border-radius: 12px; box-shadow: var(--box-shadow); padding: 1rem; text-decoration: none; color: inherit; display: flex; flex-direction: column; }
			.cover { width: 100%; aspect-ratio: 16/9; object-fit: cover; border-radius: 8px; background: rgb(var(--gray-light)); }
			.card h3 { margin-top: .75rem; }
			.card p { margin: 0; color: rgb(var(--gray)); }
			.section-title { max-width: 960px; margin: 0 auto; padding: 0 1rem; }
			@media (max-width: 1024px) { .grid { grid-template-columns: repeat(2, 1fr); } }
			@media (max-width: 640px) { .grid { grid-template-columns: 1fr; } }
		</style>
	</head>
	<body>
		<Header />
		<main>
			<section class="hero">
				<h1>We are CORXLAB</h1>
				<p>Indie game developer studio. Read our devlog and news, and discover our games.</p>
				<div class="stack">
					<span class="badge">Unity</span>
					<span class="badge">Unreal Engine</span>
					<span class="badge">Godot</span>
				</div>
			</section>

			<h2 class="section-title">Game Showcase</h2>
			<div class="grid">
				{games.map(({ id, data }) => (
					<a class="card" href={`/games/${id}/`}>
						{data.coverImage ? (
							<img class="cover" src={data.coverImage.src} alt={data.title} width={data.coverImage.width} height={data.coverImage.height} />
						) : (
							<div class="cover" />
						)}
						<h3>{data.title}</h3>
						<p>{data.description}</p>
					</a>
				))}
			</div>
		</main>
		<Footer />
	</body>
</html>
